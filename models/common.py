from enum import Enum
from typing import Optional
from uuid import UUID

from pydantic import RootModel, Field
from typing_extensions import Annotated

MispID = RootModel[Annotated[
    Optional[str], Field(None, examples=["12345"], max_length=10, pattern="^\\d+$")
]]


class AttributeType(str, Enum):
    MD5 = "md5"
    SHA1 = "sha1"
    SHA256 = "sha256"
    FILENAME = "filename"
    PDB = "pdb"
    FILENAME_MD5 = "filename|md5"
    FILENAME_SHA1 = "filename|sha1"
    FILENAME_SHA256 = "filename|sha256"
    IP_SRC = "ip-src"
    IP_DST = "ip-dst"
    HOSTNAME = "hostname"
    DOMAIN = "domain"
    DOMAIN_IP = "domain|ip"
    EMAIL = "email"
    EMAIL_SRC = "email-src"
    EPPN = "eppn"
    EMAIL_DST = "email-dst"
    EMAIL_SUBJECT = "email-subject"
    EMAIL_ATTACHMENT = "email-attachment"
    EMAIL_BODY = "email-body"
    FLOAT = "float"
    GIT_COMMIT_ID = "git-commit-id"
    URL = "url"
    HTTP_METHOD = "http-method"
    USER_AGENT = "user-agent"
    JA3_FINGERPRINT_MD5 = "ja3-fingerprint-md5"
    JARM_FINGERPRINT = "jarm-fingerprint"
    FAVICON_MMH3 = "favicon-mmh3"
    HASSH_MD5 = "hassh-md5"
    HASSHSERVER_MD5 = "hasshserver-md5"
    REGKEY = "regkey"
    REGKEY_VALUE = "regkey|value"
    AS_ = "AS"
    SNORT = "snort"
    BRO = "bro"
    ZEEK = "zeek"
    COMMUNITY_ID = "community-id"
    PATTERN_IN_FILE = "pattern-in-file"
    PATTERN_IN_TRAFFIC = "pattern-in-traffic"
    PATTERN_IN_MEMORY = "pattern-in-memory"
    PATTERN_FILENAME = "pattern-filename"
    PGP_PUBLIC_KEY = "pgp-public-key"
    PGP_PRIVATE_KEY = "pgp-private-key"
    YARA = "yara"
    STIX2_PATTERN = "stix2-pattern"
    SIGMA = "sigma"
    GENE = "gene"
    KUSTO_QUERY = "kusto-query"
    MIME_TYPE = "mime-type"
    IDENTITY_CARD_NUMBER = "identity-card-number"
    COOKIE = "cookie"
    VULNERABILITY = "vulnerability"
    CPE = "cpe"
    WEAKNESS = "weakness"
    ATTACHMENT = "attachment"
    MALWARE_SAMPLE = "malware-sample"
    LINK = "link"
    COMMENT = "comment"
    TEXT = "text"
    HEX = "hex"
    OTHER = "other"
    NAMED_PIPE = "named pipe"
    MUTEX = "mutex"
    PROCESS_STATE = "process-state"
    TARGET_USER = "target-user"
    TARGET_EMAIL = "target-email"
    TARGET_MACHINE = "target-machine"
    TARGET_ORG = "target-org"
    TARGET_LOCATION = "target-location"
    TARGET_EXTERNAL = "target-external"
    BTC = "btc"
    DASH = "dash"
    XMR = "xmr"
    IBAN = "iban"
    BIC = "bic"
    BANK_ACCOUNT_NR = "bank-account-nr"
    ABA_RTN = "aba-rtn"
    BIN = "bin"
    CC_NUMBER = "cc-number"
    PRTN = "prtn"
    PHONE_NUMBER = "phone-number"
    THREAT_ACTOR = "threat-actor"
    CAMPAIGN_NAME = "campaign-name"
    CAMPAIGN_ID = "campaign-id"
    MALWARE_TYPE = "malware-type"
    URI = "uri"
    AUTHENTIHASH = "authentihash"
    VHASH = "vhash"
    SSDEEP = "ssdeep"
    IMPHASH = "imphash"
    TELFHASH = "telfhash"
    PEHASH = "pehash"
    IMPFUZZY = "impfuzzy"
    SHA224 = "sha224"
    SHA384 = "sha384"
    SHA512 = "sha512"
    SHA512_224 = "sha512/224"
    SHA512_256 = "sha512/256"
    SHA3_224 = "sha3-224"
    SHA3_256 = "sha3-256"
    SHA3_384 = "sha3-384"
    SHA3_512 = "sha3-512"
    TLSH = "tlsh"
    CDHASH = "cdhash"
    FILENAME_AUTHENTIHASH = "filename|authentihash"
    FILENAME_VHASH = "filename|vhash"
    FILENAME_SSDEEP = "filename|ssdeep"
    FILENAME_IMPHASH = "filename|imphash"
    FILENAME_IMPFUZZY = "filename|impfuzzy"
    FILENAME_PEHASH = "filename|pehash"
    FILENAME_SHA224 = "filename|sha224"
    FILENAME_SHA384 = "filename|sha384"
    FILENAME_SHA512 = "filename|sha512"
    FILENAME_SHA512_224 = "filename|sha512/224"
    FILENAME_SHA512_256 = "filename|sha512/256"
    FILENAME_SHA3_224 = "filename|sha3-224"
    FILENAME_SHA3_256 = "filename|sha3-256"
    FILENAME_SHA3_384 = "filename|sha3-384"
    FILENAME_SHA3_512 = "filename|sha3-512"
    FILENAME_TLSH = "filename|tlsh"
    WINDOWS_SCHEDULED_TASK = "windows-scheduled-task"
    WINDOWS_SERVICE_NAME = "windows-service-name"
    WINDOWS_SERVICE_DISPLAYNAME = "windows-service-displayname"
    WHOIS_REGISTRANT_EMAIL = "whois-registrant-email"
    WHOIS_REGISTRANT_PHONE = "whois-registrant-phone"
    WHOIS_REGISTRANT_NAME = "whois-registrant-name"
    WHOIS_REGISTRANT_ORG = "whois-registrant-org"
    WHOIS_REGISTRAR = "whois-registrar"
    WHOIS_CREATION_DATE = "whois-creation-date"
    X509_FINGERPRINT_SHA1 = "x509-fingerprint-sha1"
    X509_FINGERPRINT_MD5 = "x509-fingerprint-md5"
    X509_FINGERPRINT_SHA256 = "x509-fingerprint-sha256"
    DNS_SOA_EMAIL = "dns-soa-email"
    SIZE_IN_BYTES = "size-in-bytes"
    COUNTER = "counter"
    DATETIME = "datetime"
    PORT = "port"
    IP_DST_PORT = "ip-dst|port"
    IP_SRC_PORT = "ip-src|port"
    HOSTNAME_PORT = "hostname|port"
    MAC_ADDRESS = "mac-address"
    MAC_EUI_64 = "mac-eui-64"
    EMAIL_DST_DISPLAY_NAME = "email-dst-display-name"
    EMAIL_SRC_DISPLAY_NAME = "email-src-display-name"
    EMAIL_HEADER = "email-header"
    EMAIL_REPLY_TO = "email-reply-to"
    EMAIL_X_MAILER = "email-x-mailer"
    EMAIL_MIME_BOUNDARY = "email-mime-boundary"
    EMAIL_THREAD_INDEX = "email-thread-index"
    EMAIL_MESSAGE_ID = "email-message-id"
    GITHUB_USERNAME = "github-username"
    GITHUB_REPOSITORY = "github-repository"
    GITHUB_ORGANISATION = "github-organisation"
    JABBER_ID = "jabber-id"
    TWITTER_ID = "twitter-id"
    DKIM = "dkim"
    DKIM_SIGNATURE = "dkim-signature"
    FIRST_NAME = "first-name"
    MIDDLE_NAME = "middle-name"
    LAST_NAME = "last-name"
    FULL_NAME = "full-name"
    DATE_OF_BIRTH = "date-of-birth"
    PLACE_OF_BIRTH = "place-of-birth"
    GENDER = "gender"
    PASSPORT_NUMBER = "passport-number"
    PASSPORT_COUNTRY = "passport-country"
    PASSPORT_EXPIRATION = "passport-expiration"
    REDRESS_NUMBER = "redress-number"
    NATIONALITY = "nationality"
    VISA_NUMBER = "visa-number"
    ISSUE_DATE_OF_THE_VISA = "issue-date-of-the-visa"
    PRIMARY_RESIDENCE = "primary-residence"
    COUNTRY_OF_RESIDENCE = "country-of-residence"
    SPECIAL_SERVICE_REQUEST = "special-service-request"
    FREQUENT_FLYER_NUMBER = "frequent-flyer-number"
    TRAVEL_DETAILS = "travel-details"
    PAYMENT_DETAILS = "payment-details"
    PLACE_PORT_OF_ORIGINAL_EMBARKATION = "place-port-of-original-embarkation"
    PLACE_PORT_OF_CLEARANCE = "place-port-of-clearance"
    PLACE_PORT_OF_ONWARD_FOREIGN_DESTINATION = (
        "place-port-of-onward-foreign-destination"
    )
    PASSENGER_NAME_RECORD_LOCATOR_NUMBER = "passenger-name-record-locator-number"
    MOBILE_APPLICATION_ID = "mobile-application-id"
    CHROME_EXTENSION_ID = "chrome-extension-id"
    CORTEX = "cortex"
    BOOLEAN = "boolean"
    ANONYMISED = "anonymised"


class AttributeCategory(str, Enum):
    INTERNAL_REFERENCE = "Internal reference"
    TARGETING_DATA = "Targeting data"
    ANTIVIRUS_DETECTION = "Antivirus detection"
    PAYLOAD_DELIVERY = "Payload delivery"
    ARTIFACTS_DROPPED = "Artifacts dropped"
    PAYLOAD_INSTALLATION = "Payload installation"
    PERSISTENCE_MECHANISM = "Persistence mechanism"
    NETWORK_ACTIVITY = "Network activity"
    PAYLOAD_TYPE = "Payload type"
    ATTRIBUTION = "Attribution"
    EXTERNAL_ANALYSIS = "External analysis"
    FINANCIAL_FRAUD = "Financial fraud"
    SUPPORT_TOOL = "Support Tool"
    SOCIAL_NETWORK = "Social network"
    PERSON = "Person"
    OTHER = "Other"


class DistributionLevelId(str, Enum):
    FIELD_0 = "0"
    FIELD_1 = "1"
    FIELD_2 = "2"
    FIELD_3 = "3"
    FIELD_4 = "4"
    FIELD_5 = "5"


class ThreatLevelId(str, Enum):
    FIELD_1 = "1"
    FIELD_2 = "2"
    FIELD_3 = "3"
    FIELD_4 = "4"


class AnalysisLevelId(str, Enum):
    FIELD_0 = "0"
    FIELD_1 = "1"
    FIELD_2 = "2"


class UUIDModel(RootModel[UUID]):
    root: Annotated[
        UUID, Field(examples=["c99506a6-1255-4b71-afa5-7b8ba48c3b1b"], max_length=36)
    ]


class Timestamp(RootModel[str]):
    root: Annotated[str, Field(examples=["1617875568"], pattern="^\\d+$")]


class MicroTimestamp(RootModel[str]):
    root: Annotated[str, Field(examples=["1581984000000000"], pattern="^\\d+$")]


class Local(int, Enum):
    INTEGER_0 = 0
    INTEGER_1 = 1


class ModelName(str, Enum):
    """Enumerated list of all models for MISP server.
    """
    ADMIN_SETTING = "AdminSetting"
    ALLOWEDLIST = "Allowedlist"
    ATTACHMENT_SCAN = "AttachmentScan"
    ATTRIBUTE = "Attribute"
    ATTRIBUTE_TAG = "AttributeTag"
    AUDIT_LOG = "AuditLog"
    AUTH_KEY = "AuthKey"
    BRUTEFORCE = "Bruteforce"
    CEREBRATE = "Cerebrate"
    COMMUNITY = "Community"
    CORRELATION_EXCLUSION = "CorrelationExclusion"
    CORRELATION = "Correlation"
    DASHBOARD = "Dashboard"
    DECAYING_MODEL_MAPPING = "DecayingModelMapping"
    DECAYING_MODEL = "DecayingModel"
    EVENT_BLOCKLIST = "EventBlocklist"
    EVENT_DELEGATION = "EventDelegation"
    EVENT_GRAPH = "EventGraph"
    EVENT_LOCK = "EventLock"
    EVENT = "Event"
    EVENT_REPORT = "EventReport"
    EVENT_TAG = "EventTag"
    FAVOURITE_TAG = "FavouriteTag"
    FEED = "Feed"
    FUZZY_CORRELATE_SSDEEP = "FuzzyCorrelateSsdeep"
    GALAXY_CLUSTER_BLOCKLIST = "GalaxyClusterBlocklist"
    GALAXY_CLUSTER = "GalaxyCluster"
    GALAXY_CLUSTER_RELATION = "GalaxyClusterRelation"
    GALAXY_CLUSTER_RELATION_TAG = "GalaxyClusterRelationTag"
    GALAXY_ELEMENT = "GalaxyElement"
    GALAXY = "Galaxy"
    INBOX = "Inbox"
    JOB = "Job"
    LOG = "Log"
    MISP_OBJECT = "MispObject"
    MODULE = "Module"
    NEWS = "News"
    NOTICELIST_ENTRY = "NoticelistEntry"
    NOTICELIST = "Noticelist"
    NOTIFICATION_LOG = "NotificationLog"
    OBJECT_REFERENCE = "ObjectReference"
    OBJECT_RELATIONSHIP = "ObjectRelationship"
    OBJECT_TEMPLATE_ELEMENT = "ObjectTemplateElement"
    OBJECT_TEMPLATE = "ObjectTemplate"
    ORGANISATION = "Organisation"
    ORG_BLOCKLIST = "OrgBlocklist"
    POST = "Post"
    REGEXP = "Regexp"
    REST_CLIENT_HISTORY = "RestClientHistory"
    ROLE = "Role"
    SERVER = "Server"
    SHADOW_ATTRIBUTE = "ShadowAttribute"
    SHARING_GROUP_ORG = "SharingGroupOrg"
    SHARING_GROUP = "SharingGroup"
    SHARING_GROUP_SERVER = "SharingGroupServer"
    SIGHTINGDB_ORG = "SightingdbOrg"
    SIGHTINGDB = "Sightingdb"
    SIGHTING = "Sighting"
    TAG_COLLECTION = "TagCollection"
    TAG_COLLECTION_TAG = "TagCollectionTag"
    TAG = "Tag"
    TASK = "Task"
    TAXONOMY_ENTRY = "TaxonomyEntry"
    TAXONOMY = "Taxonomy"
    TAXONOMY_PREDICATE = "TaxonomyPredicate"
    TEMPLATE_ELEMENT_ATTRIBUTE = "TemplateElementAttribute"
    TEMPLATE_ELEMENT_FILE = "TemplateElementFile"
    TEMPLATE_ELEMENT = "TemplateElement"
    TEMPLATE_ELEMENT_TEXT = "TemplateElementText"
    TEMPLATE = "Template"
    TEMPLATE_TAG = "TemplateTag"
    THREAD = "Thread"
    THREAT_LEVEL = "ThreatLevel"
    USER = "User"
    USER_SETTING = "UserSetting"
    WARNINGLIST_ENTRY = "WarninglistEntry"
    WARNINGLIST = "Warninglist"
    WARNINGLIST_TYPE = "WarninglistType"
